function getJSON(e,o){var t=new XMLHttpRequest;t.open("GET",e,!0),t.onload=function(){if(t.status>=200&&t.status<400){var e=JSON.parse(t.responseText);o(e,t)}},t.onerror=function(){},t.send()}function getData(){getJSON("http://ip-api.com/json",function(e){console.log(e),document.getElementById("ip").innerHTML=e.query,document.getElementById("country").innerHTML=e.countryCode+" / "+e.country,document.getElementById("isp").innerHTML=e.isp,createMap({lo:e.lon,la:e.lat,country:e.country}),browser.browserAction.setBadgeText({text:e.country_code})})}function createMap(e){var o=document.getElementById("map");o.src="https://www.google.com/maps/embed/v1/view?key="+apiKey+"&center="+e.la+","+e.lo+"&zoom=8",o.onload=function(){console.log("map loaded")}}var apiKey="AIzaSyAjVDotm8EmgZNby4xSEDxcf5oHh4OmNik";window.browser=window.msBrowser||window.browser||window.chrome,getData();